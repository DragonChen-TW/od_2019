{% extends 'base.html '%}

{% block style %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
<style>
    html, body{
        width: 100%;
        height: 100%;
    }
    #map{
        width: 80%;
        height: 85%;
        margin-left: 10%;
    }
</style>
{% endblock %}

{% block script %}
<div id="map"> </div>
<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>

<script>
    var map;
    map = L.map('map').setView([22.62,120.27], 16);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '<a href="https://www.openstreetmap.org/">OSM</a>',
        maxZoom: 18,
    }).addTo(map);


    /* Marker */
    // get json inside django
    var houses = JSON.parse('{{houses | safe}}');
    // get json outside django using ajax
    // pass

    // draw
    for (const h of houses) {  // iter each elements of houses
        var marker = L.marker([h['lat'], h['lng']]);
        marker.addTo(map);
        marker.bindPopup(h['name']+"</br>"+h['address']);
    }


</script>
{% endblock %}
